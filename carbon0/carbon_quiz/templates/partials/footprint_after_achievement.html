<!-- carbon0/carbon_quiz/templates/partials/footprint_after_achievement.html -->
<style>
    #new-footprint-card{
        /*  */
        background-color: rgba(20, 57, 99, 0);
        /* background-color:  #143963; */
        border: 1px solid transparent;
    }
</style>
<div class="card mb-3" id="new-footprint-card">
    <div class="card-body">
        <h4 class="card-title" style="color:white;">Your NEW Carbon Footprint</h4>
        <h5 class="card-text"><strong id="new-footprint"></strong></h5>

        <div id="chartdiv" style="width: 320px; height: 220px;"></div>

        <!-- <script type="module">
            import { footprintPlot } from '../../../../static/js/amGuageChart.js';
            footprintPlot({{ achievement.quiz.previous_carbon_value }}, {{ achievement.quiz.carbon_value_total }})
        </script> -->

        <!-- Display of Bar Chart -->
        <!-- <canvas id="carbonCalculator" width="1000rem" height="560rem"></canvas> -->
        <!-- JS to make the bar chart -->
        
        <script type="module">
            import { footprintPlot } from '../../../../static/js/amGuageChart.js';
            $(document).ready(function () {
                // get the data on the carbon footprint from the API
                let endpoint = '/api/achievement-data/{{ achievement.id }}/'
                let plotData = []
                let plotLabels = [];
                $.ajax({
                    method: "GET",
                    url: endpoint,
                    success: function (data) {
                        plotData = data.footprint;
                        footprintPlot({{ achievement.quiz.carbon_value_total }}, plotData[0]);
                        // use the same data to title the card
                        let title = document.getElementById("new-footprint");
                        title.innerText = plotData[0] + " metric tons CO2"
                        // let text = document.createTextNode(" metric tons CO2");
                    },
                    error: function (error_data) {
                        console.log(error_data)
                    }
                })
            })
        </script>
    </div>
</div>
