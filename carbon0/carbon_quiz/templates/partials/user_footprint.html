<!-- carbon0/carbon_quiz/templates/partials/user_footprint.html -->
<div class="card" style="background-color:rgb(255, 220, 176)">
    <div class="card-body">
        <h4 class="card-title" style="color:brown;">Your Updated Carbon Footprint</h4>
        <h5 class="card-text"><strong id="new-footprint"></strong></h5>
        <!-- Display of Bar Chart -->
        <canvas id="barChart" width="700" height="160rem"></canvas>
        <!-- JS to make the bar chart -->
        <script type="module">
            import { barChart } from '../../../../static/js/barChartFunction.js';
            $(document).ready(function () {
                // get the data on the carbon footprint from the API
                let endpoint = '/api/profile-data/{{ profile.id }}/'
                let plotData = []
                let plotLabels = [];
                $.ajax({
                    method: "GET",
                    url: endpoint,
                    success: function (data) {
                        // plot the bar chart
                        plotLabels = data.labels;
                        plotData = data.footprint;
                        barChart(plotLabels, plotData);
                        // use the same data to title the card
                        let title = document.getElementById("new-footprint");
                        let text = document.createTextNode(plotData + " metric tons CO2");
                        title.appendChild(text);
                    },
                    error: function (error_data) {
                        console.log(error_data)
                    }
                })
            })
        </script>
    </div>
</div>