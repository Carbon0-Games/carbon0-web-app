<!-- carbon0/garden/templates/partials/plant_card.html-->
<div class="carbon0-button card border-info mb-3">
    <div class="row card-header justify-content-center">
        <!-- Nickname is How the User Can identify their plants -->
        <div class="col-md-8">
            <h3>{{ plant.nickname }}</h3>
        </div>
        <!-- User also gets buttons to do an action -->
        <div class="col-md-4">
             <a href="#" class="btn btn-info">See More</a>
        </div>
    </div>
    <div class="card-body border-dark">
        <div class="row justify-content-center">
            <!-- Display the Latest Updated of the Plant -->
            <div id="health-preview-{{ plant.id }}" class="col-md-8">
            </div>
            <!-- User can Delete the Plant -->
            <div class="col-md-4">
                <a href="#" class="btn btn-danger">Delete</a>
            </div>
        </div>
        <hr>
        <!-- User sees an image of the plant -->
        <div class="text-right">
            {% if plant.is_edible is True %}
                <img src="{% static 'icons/Veggie_Bowl.png' %}" 
                class="card-img-top" alt="Edible plant image">
            {% else %} <!-- the plant is helping sequester carbon dioxide -->
                <img src="{% static 'icons/Flying.png' %}" 
                class="card-img-top" alt="Plants helps us to sequester CO2!" />
            {% endif %}
        </div>
    </div>
</div>

<!-- JS to give the health preview -->
<script type="module">
    import { displayHealthPreview } from '../../../../static/js/healthPreview.js';
    $(document).ready(function () {
        // get the data on the plant's current health
        let endpoint = "{% url 'api:plant_healh_preview' plant.id %}"
        let lastStatus = "";
        let lastUpdated = "";
        const elemID = "health-preview-{{ plant.id }}";
        $.ajax({
            method: "GET",
            url: endpoint,
            success: function (data) {
                lastStatus = data.latestStatus;
                lastUpdated = data.lastUpdated;
                displayHealthPreview(elemID, lastStatus, lastUpdated);
            },
            error: function (error_data) {
                console.log(error_data)
            }
        })
    })
</script>